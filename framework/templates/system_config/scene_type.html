<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
    <meta charset="UTF-8">
    <title>场景分组</title>

    <script src="${STATIC_URL}assets/vue-2.5.21/vue.development.js"></script>
    <!-- 生产环境版本，优化了尺寸和速度 功能完善后请将vue.development.js该为vue.js-->
    <!--<script src="${STATIC_URL}assets/vue-2.5.21/vue.js"></script>-->
    <!-- vue的ajax依赖-->
    <script src="${STATIC_URL}assets/vue-2.5.21/axios.min.js"></script>
    <!-- element UI引入样式 -->
    <link href="${STATIC_URL}assets/element-2.4.11/index.css" rel="stylesheet">
    <!-- element UI引入组件库 -->
    <script src="${STATIC_URL}assets/element-2.4.11/index.js"></script>
    <script src='${STATIC_URL}js/jquery.min.js'></script>
    <script src='${STATIC_URL}js/jquery-ui.js'></script>
    <!--jQuery库使用时请使用标准jQuery语法-->
    <!--<script src="${STATIC_URL}assets/jquery/jquery-3.1.1.min.js"></script>-->
    <!--页面初始化css(Tencent)-->
    <link href="${STATIC_URL}css/init.css" rel="stylesheet">

</head>
<body style="height: 100%">
<div id="app" style="height: 100%;">
    <!--start 面包屑-->
    <el-breadcrumb separator-class="el-icon-arrow-right" separator="/" style="margin: 20px;">
        <el-breadcrumb-item><a href="/">系统配置</a></el-breadcrumb-item>
        <el-breadcrumb-item>场景分组配置</el-breadcrumb-item>
        <el-breadcrumb-item>抓取配置</el-breadcrumb-item>
    </el-breadcrumb>
    <!--end 面包屑-->

    <!--start 卡片 列表页-->
    <el-card class="box-card" style="margin: 20px;" style="height: 100%">
        <div slot="header" class="clearfix">
            <div class="grid-content bg-purple"><h2>场景分组配置</h2></div>
            <br>
            <el-row :gutter="20">
                <el-col :span="20">
                    <el-form :inline="true" class="demo-form-inline">
                        <el-form-item label="场景分组名称：">
                            <el-input placeholder="请输入场景分组名称"></el-input>
                        </el-form-item>
                        <el-form-item>
                            <el-button type="primary" @click="dialogFormVisible = true">查询</el-button>
                        </el-form-item>

                    </el-form>
                </el-col>
                <el-col :span="4" style="float: right">
                    <div class="grid-content bg-purple">
                        <el-button type="primary"  @click="dialogFormVisible = true">新增爬虫信息</el-button>
                    </div>
                </el-col>
            </el-row>
        </div>
        <template>
            <el-table
                    :data="tableData"
                    stripe
                    style="width: 100%">
                <el-table-column
                        prop="id"
                        label="ID"
                        width="180">
                </el-table-column>
                <el-table-column
                        prop="scene_type_id"
                        label="ID"
                        width="180">
                </el-table-column>
                <el-table-column
                        prop="scene_type_name"
                        label="场景类型名称"
                        width="180">
                </el-table-column>
                <el-table-column
                        prop="create_user"
                        label="创建人">
                </el-table-column>
                <el-table-column
                        prop="create_time"
                        label="创建时间">
                </el-table-column>
                <el-table-column
                        prop="update_user"
                        label="最后修改人">
                </el-table-column>
                <el-table-column
                        prop="update_time"
                        label="最后修改时间">
                </el-table-column>
                <el-table-column label="操作">
                    <template slot-scope="scope">
                        <el-button size="mini" type="text" v-on:click="edit_dialog(scope.row.scene_type_id)">编辑</el-button>
                        <el-button size="mini" type="text" v-on:click="delete_scene_by_uuid(scope.row.scene_type_id)">
                            删除
                        </el-button>
                        </el-tooltip>
                    </template>
                </el-table-column>
            </el-table>
        </template>

    </el-card>
    <!--end 卡片 列表页-->
    <el-dialog title="收货地址" :visible.sync="dialogFormVisible">
        <el-form>
        </el-form>
        <div slot="footer" class="dialog-footer">
            <el-button @click="dialogFormVisible = false">取 消</el-button>
            <el-button type="primary" @click="dialogFormVisible = false">确 定</el-button>
        </div>
    </el-dialog>
</div>


<script>
    //csrf验证
    axios.interceptors.request.use((config) => {
        config.headers['X-Requested-With'] = 'XMLHttpRequest';
        let regex = /.*csrftoken=([^;.]*).*$/; // 用于从cookie中匹配 csrftoken值
        config.headers['X-CSRFToken'] = document.cookie.match(regex) === null ? null : document.cookie.match(regex)[1];
        return config
    });

    let vm = new Vue({
        el: '#app',
        data: {
            showDiaLog: true,
            tableData: [],
            dialogFormVisible: false,
        },
        methods: {
            get_scene_type() {
                axios({
                    url: '${SITE_URL}system_config/get_scene_type'
                }).then((res) => {
                    console.log(res);
                    vm.tableData = res.data.results;
                }).catch((res) => {
                    console.log(res)
                })
            },
            delete_scene_by_uuid(uuid) {
                console.log(uuid)
                axios({
                    url: '${SITE_URL}system_config/delete_scene_by_uuid',
                    methods: 'post',
                }).then((res) => {
                    console.log(res)
                }).catch((res) => {
                    console.log(res)
                })
            },
            edit_scene_type_by_uuid() {
                axios({
                    url: '${SITE_URL}system_config/edit_scene_type_by_uuid',
                    methods: 'post',
                    data: ''
                }).then((res) => {
                    console.log(res)
                }).catch((res) => {
                    console.log(res)
                })
            },
            add_scene_type() {
                axios({
                    url: '${SITE_URL}system_config/add_scene_type',
                    methods: 'post',
                    data: ''
                }).then((res) => {
                    console.log(res)
                }).catch((res) => {
                    console.log(res)
                })
            },
            edit_dialog(uuid){
                vm.dialogFormVisible = true;
                axios({
                    url:'${SITE_URL}system_config/get_scene_type',
                    methods:'post',
                    data:{uuid:uuid}
                }).then((res) => {
                    console.log(res)
                }).catch((res) => {
                    console.log(res)
                })
            }
        }
    });
    vm.get_scene_type();
</script>
</body>
</html>