<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>title</title>

    <script src="${STATIC_URL}assets/vue-2.5.21/vue.development.js"></script>
    <link href="${STATIC_URL}assets/element-2.4.11/index.css" rel="stylesheet">
    <script src="${STATIC_URL}assets/element-2.4.11/index.js"></script>
    <script src="${STATIC_URL}assets/vue-2.5.21/axios.min.js"></script>
    <link type="text/css" href="${STATIC_URL}css/monitorScene/style.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/v-charts/lib/index.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-charts/lib/style.min.css">
    <link href="https://magicbox.bk.tencent.com/static_api/v3/bk/css/bk.css" rel="stylesheet">
    <link href="https://magicbox.bk.tencent.com/static_api/v3/assets/jrange/css/jquery.range.css" rel="stylesheet">
    <script src="https://magicbox.bk.tencent.com/static_api/v3/assets/js/jquery-1.10.2.min.js"></script>
    <script src="${STATIC_URL}js/jquery.range-min.js"></script>


    <link rel="stylesheet" href="https://magicbox.bk.tencent.com/static_api/v3/assets/bk-icon-2.0/iconfont.css">
    <script type="text/javascript"
            src="https://magicbox.bk.tencent.com/static_api/v3/assets/dataflow-2.0/js/jsplumb.min.js"></script>
    <link rel="stylesheet"
          href="https://magicbox.bk.tencent.com/static_api/v3/assets/dataflow-2.0/css/jsPlumbToolkit-defaults.css"/>
    <script type="text/javascript" src="${STATIC_URL}js/dataflow/dataflow.js"></script>
    <link rel="stylesheet" href="${STATIC_URL}css/monitorScene/dataflow-index.css">
    <style>
        .Drigging {

            width: 200px;

            background: #CCC;

            border: solid 1px #666;

            height: 80px;

            line-height: 80px;

            text-align: center;

            position: absolute;
        }
        .monitor_type{
            line-height: 48px;
            background: #28359324;
            text-align: center;
        }
        .monitor_list{
            display: none;
        }
        .monitor_list div{
            text-align: center;
        }
        .el-row{
            border: 1px solid #ffffff;
        }
        .el-col{
            border: 1px solid #ffffff;
        }
        p,i{
            text-align: center;
        }
    </style>
</head>

<body>
<div id="app" style="width: 100%;height: auto;min-height: 600px">
    <el-row>
        <el-col :span="24">
            <h1 style="rgba(40, 147, 108, 0.45);line-height: 60px;text-align: center">场景编排</h1>
        </el-col>
        <el-col :span="4">
            <div style="height:auto;min-height: 600px;background: rgb(244, 244, 245)">
                <h2 class="monitor_title" style="line-height:48px;background:#283593;text-align: center;color: #ffffff">监控项</h2>
                <el-col :span="24">
                        <h3 class="monitor_type">基本监控项</h3>
                </el-col>
                <div class="monitor_list">
                    <el-col :span="12" v-for="(i,index) in base_monitor" :key="index">
                        <div @click="add_monitor(i)">
                            <p>{{ i }}</p>
                            <i class="bk-icon icon-monitors"></i>
                        </div>

                    </el-col>
                    <el-pagination :page-count="page_count" background layout="prev, pager, next" style="float:right"
                           @current-change="current_change1"></el-pagination>
                </div>
                <el-col :span="24">
                        <h3 class="monitor_type">图表监控项</h3>
                </el-col>
                <div class="monitor_list">
                    <el-col :span="12" v-for="(i,index) in chart_monitor" :key="index">
                        <div>
                            <p>{{ i }}</p>
                            <i class="bk-icon icon-panel-permission"></i>
                        </div>
                    </el-col>
                    <el-pagination :page-count="page_count" background layout="prev, pager, next" style="float:right"
                           @current-change="current_change2"></el-pagination>
                </div>
                <el-col :span="24">
                        <h3 class="monitor_type">作业监控项</h3>
                </el-col>
                <div class="monitor_list">
                    <el-col :span="12" v-for="(i,index) in job_monitor" :key="index">
                        <div>
                            <p>{{ i }}</p>
                            <i class="bk-icon icon-monitors"></i>
                        </div>
                    </el-col>
                    <el-pagination :page-count="page_count" background layout="prev, pager, next" style="float:right"
                           @current-change="current_change3"></el-pagination>
                </div>
                <el-col :span="24">
                        <h3 class="monitor_type">流程监控项</h3>
                </el-col>
                <div class="monitor_list">
                    <el-col :span="12" v-for="(i,index) in flow_monitor" :key="index">
                        <div>
                            <p>{{ i }}</p>
                            <i class="bk-icon icon-monitors"></i>
                        </div>
                    </el-col>
                    <el-pagination :page-count="page_count" background layout="prev, pager, next" style="float:right"
                           @current-change="current_change4"></el-pagination>
                </div>
            </div>
        </el-col>
        <el-col :span="20">
            <div class="monitor_content" style="min-height: 600px;background: rgb(244, 244, 245)">
            </div>
        </el-col>
    </el-row>
</div>


<script type="text/javascript">
    var vm = new Vue({
        el: '#app',
        data:{
            page_count:4,
            page:1,
            monitor_type:0,
            limit:4,
            base_monitor:[1,2,3,4],
            chart_monitor:[5,6,7,8],
            job_monitor:['a','b','c','d'],
            flow_monitor:['q','w','e','r'],
            drigging_id:1,
        },
        methods:{
            show(){
                axios({
                    method: 'post',
                    url: '${SITE_URL}main/scene_show/',
                    data: {
                        limit:vm.limit,
                        type:vm.monitor_type,
                        page:vm.page
                    },
                }).then((res)=> {
                    console.log(res)
                }).catch((error) => {
                alert('获取数据失败！')
                });
            },
            add_monitor(i){
                $('.monitor_content').append('<div class=\"Drigging\" type=\"'+i+'\" id=\"'+vm.drigging_id+'\">123</div>')
                vm.drigging_id++
            },
            current_change1(value) {
                vm.page = value;
                vm.monitor_type=1;
                vm.show()
            },
            current_change2(value) {
                vm.page = value;
                vm.monitor_type=2;
                vm.show()
            },
            current_change3(value) {
                vm.page = value;
                vm.monitor_type=3;
                vm.show()
            },
            current_change4(value) {
                vm.page = value;
                vm.monitor_type=4;
                vm.show()
            },

        }
    });
    vm.show();
    $('.monitor_type').click(function () {
        $(this).parent().next('div').animate({
           height:'toggle'
        });
        $(this).parent().next('div').siblings('.monitor_list').animate({
            height:"hide"
        });
    });
    $(function () {
        var selector = '';
        var bool = false; //标识是否移动元素
        var offsetX = 0; //声明p在当前窗口的Left值
        var offsetY = 0; //声明p在当前窗口的Top值
        $(document).on("mouseover", ".Drigging", function () {
            $(this).css('cursor', 'pointer');//当鼠标移动到拖拽的p上的时候，将鼠标的样式设置为移动(move)
        });
        $(document).on("mousedown", ".Drigging", function () {
            selector = '#' + this.id;
            bool = true;//当鼠标在移动元素按下的时候将bool设定为true
            offsetX = event.offsetX;//获取鼠标在当前窗口的相对偏移位置的Left值并赋值给offsetX
            offsetY = event.offsetY;//获取鼠在当前窗口的相对偏移位置的Top值并赋值给offsetY
            $(this).css('cursor', 'pointer');
        });
        $(document).on("mouseup", ".Drigging", function () {
            bool = false;//当鼠标在移动元素起来的时候将bool设定为false
        });
        $(document).mousemove(function () {
            if (!bool)//如果bool为false则返回
                return;//当bool为true的时候执行下面的代码
            var x = event.clientX - offsetX;
            //event.clientX得到鼠标相对于客户端正文区域的偏移
            //然后减去offsetX即得到当前推拽元素相对于当前窗口的X值
            //（减去鼠标刚开始拖动的时候在当前窗口的偏移X）
            var y = event.clientY - offsetY;
            //event.clientY得到鼠标相对于客户端正文区域的偏移
            //然后减去offsetX即得到当前推拽元素相对于当前窗口的Y值
            //（减去鼠标刚开始拖动的时候在当前窗口的偏移Y）
            $(selector).css("left", x);
            $(selector).css("top", y);
            $(selector).css('cursor', 'pointer');
        });
        $(document).on("mousedown", ".Drigging", function (e) {
            if (3 == e.which) {
                alert('这 是右键单击事件');
            }
        });
    });
    //$('.tool-title').click(function () {
    //$(this).next('.tool-list').animate({
    //    height:'toggle'
    //});
    //$(this).parent().siblings().children('.tool-list').animate({
    //    height:"hide"
    //});
    //});
    //<p id="Drigging" class="Drigging" style="float:left">拖拽层</p>
    //<p id="Drigging1" class="Drigging" style="position: absolute;top: 150px;">拖拽层1</p>
</script>
</body>

</html>


