<html>
<head>
    <meta charset="UTF-8">
    <!-- 开发环境版本，包含了有帮助的命令行警告--2.5.51 -->
    <script src="${STATIC_URL}assets/vue-2.5.21/vue.development.js"></script>
    <!-- element UI引入样式 -->
    <link rel="stylesheet" href="${STATIC_URL}assets/element-2.4.11/index.css">
    <!-- element UI引入组件库 -->
    <script src="${STATIC_URL}assets/element-2.4.11/index.js"></script>
    <!--axios.min.js--vue.js的ajax支持-->
    <script src="${STATIC_URL}assets/vue-2.5.21/axios.min.js"></script>
    <script src="${STATIC_URL}assets/jquery/jquery-3.1.1.min.js"></script>
    <link type="text/css" href="${STATIC_URL}css/home.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/v-charts/lib/style.min.css">


    <script type="text/javascript"
            src="https://magicbox.bk.tencent.com/static_api/v3/assets/dataflow-2.0/js/jsplumb.min.js"></script>
    <link rel="stylesheet"
          href="https://magicbox.bk.tencent.com/static_api/v3/assets/dataflow-2.0/css/jsPlumbToolkit-defaults.css"/>
    <script type="text/javascript" src="${STATIC_URL}js/dataflow/dataflow2.0.js"></script>
    <link rel="stylesheet" href="${STATIC_URL}css/monitorScene/dataflow-index.css">
    <link rel="stylesheet" href="https://magicbox.bk.tencent.com/static_api/v3/assets/bk-icon-2.0/iconfont.css">
    <script type="text/javascript" src="${STATIC_URL}assets/echarts/echarts.js"></script>
    <script type="text/javascript" src="${STATIC_URL}assets/echarts/macarons.js"></script>
    <link rel="stylesheet" href="${STATIC_URL}css/maintenanceIndex/maintenanceIndex.css">
    <style>
        input {
            width: 250px;
            height: 30px;
        }

        .el-table--border th {
            padding: 5px
        }
        .circle1{display: inline-block;margin-left:5px;width:16px;height:16px;background-color:lawngreen;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;}
        .circle2{display: inline-block;margin-left:5px;width:16px;height:16px;background-color:darkgreen;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;}
        .circle3{display: inline-block;margin-left:5px;width:16px;height:16px;background-color:grey;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;}
        .circle4{display: inline-block;margin-left:5px;width:16px;height:16px;background-color:red;border-radius:50%;-moz-border-radius:50%;-webkit-border-radius:50%;}
        .asd{display: inline-block;}
    </style>
</head>
<body>
<div id="app">
    <!-- div1 start-->
    <div class="div1" style="padding: 20px 40px 0px 40px;">
        <div>
            <el-input placeholder="请输入内容" clearable v-model="contents" style="width:30%"></el-input>
            <el-button type="primary" icon="el-icon-search" v-on:click="select1">搜索</el-button>
            <el-popover placement="top-start" width="200" trigger="hover" content="新增一个监控项。" style="float:right;">
                <el-button slot="reference" v-on:click="add_unit(0)">新增</el-button>
            </el-popover>
        </div>
        <div style="height: 20px"></div>
        <div>
            <el-table :data='sites' :header-cell-style='rowclass' style="width: 100%;" border header-align="center">
                <el-table-column prop="id" label="序号" sortable></el-table-column>
                <el-table-column prop="monitor_name" label="监控名称" sortable></el-table-column>
                <el-table-column prop="monitor_type" label="监控类型" sortable></el-table-column>
                <el-table-column prop="editor" label="编辑人" sortable></el-table-column>
                <el-table-column prop="edit_time" label="修改时间" sortable></el-table-column>
                <el-table-column label="操作">
                    <template slot-scope="scope">
                        <!--<el-button id="button1" type="text" size="small" v-on:click="edit(scope.row.id)" >编辑</el-button>-->
                        <el-button size="mini" type="text" v-on:click="edit_unit(scope.row)">编辑</el-button>
                        <el-button size="mini" type="text" v-on:click="delete_unit(scope.row)">删除</el-button>
                        <el-tooltip :content="scope.row.status" placement="top">
                            <el-switch  v-model="scope.row.status" active-color="#13ce66" inactive-color="#ff4949" @change="switch_change(scope.row)"
                                       active-value="1" inactive-value="0"></el-switch>
                            </el-tooltip>
                    </template>
                </el-table-column>
            </el-table>
            <el-pagination :page-count="page_count" background layout="prev, pager, next" style="float:right"
                           @current-change="current_change1"></el-pagination>
        </div>
    </div>
    <!-- div1 end-->

    <!-- 对话框 start-->
    <el-dialog title="基本信息" :visible.sync="centerDialogVisible" width="80%">
        <HR align=center width=100% color=#979797 SIZE=0.5>
        <div style="height: 30px"></div>
        <div>
            <span>监控监控项名称</span>
            <el-input placeholder="请输入监控项名称" v-model="monitor_name" style="width: 30%"></el-input>
        </div>
        <div style="height: 30px"></div>
        <span>
            <el-tabs type="card" v-model="monitor_type">

                <!--基本单元 start-->
                <el-tab-pane :disabled="disabled2" label="基本监控项" name="first">
                    <el-row>
                        <el-col :span="12"><div class="grid-content bg-purple">
                            <el-form :model="basic" ref="basic" :rules="rules1" label-width="100px">
                                <el-form-item label="字号" prop="font_size">
                                    <el-select v-model="basic.font_size" placeholder="请选择字号" @change="basic_size">
                                        <el-option v-for="i in font_size_range" :label=i :value=i></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="高Ⅹ宽" required style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item prop="height">
                                            <el-input type="number" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="basic.height"
                                                      placeholder="请输入高度" @change="basic_height"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col class="line" :span="2">Ⅹ</el-col>
                                    <el-col :span="11">
                                        <el-form-item prop="width">
                                              <el-input type="number" v-model.number="numberValidateForm.age"
                                                        auto-complete="off" v-model="basic.width"
                                                        placeholder="请输入宽度" @change="basic_width"></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                <el-form-item label="显示内容" prop="contents" style="width: 96%">
                                        <el-input v-model="basic.contents" placeholder="上证指数:3000  深证指数:3000" @change="sycontent"
                                                  type="textarea"></el-input>
                                </el-form-item>
                                <el-form-item label="数据来源">
                                    <el-radio-group v-model="sql_file_interface" @change="change1"
                                                    style="padding: 14px">
                                        <el-radio :label="3">数据库</el-radio>
                                        <el-radio :label="6">文件</el-radio>
                                        <el-radio :label="9">接口</el-radio>
                                     </el-radio-group>
                                </el-form-item>
                                <div :style="{ display: sql1 }">
                                    <el-form-item label="数据库连接">
                                        <el-select v-model="server_url" placeholder="请选择数据库">
                                            <el-option v-for="i in sites1" :label="i.label"
                                                       :value="i.value"></el-option>
                                        </el-select>
                                    </el-form-item>
                                </div>
                                <div :style="{display:file1}">
                                    <el-form-item label="服务器">
                                        <el-input placeholder="请输入服务器" v-model="server_url"
                                                  style="width: 96%"></el-input>
                                    </el-form-item>
                                    <el-form-item label="文件路径">
                                        <el-input placeholder="请输入文件路径" v-model="file_param"
                                                  style="width: 96%"></el-input>
                                    </el-form-item>
                                </div>
                                <div :style="{display:interface1}">
                                    <el-form-item label="url">
                                        <el-input placeholder="请输入url" v-model="server_url"
                                                  style="width: 96%"></el-input>
                                    </el-form-item>
                                    <el-form-item label="接口参数">
                                        <el-input type="textarea" v-model="file_param"></el-input>
                                    </el-form-item>
                                </div>
                                <el-form-item label="数据采集规则" style="width: 96%">
                                    <el-input v-model="basic.gather_rule" placeholder="select * from tb_hq" type="textarea"></el-input>
                                </el-form-item>
                                <el-form-item label="采集时间段:" style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="basic.start_time"
                                                            placeholder="开始时间点" format="HH:mm" value-format="HH:mm" >
                                            </el-time-picker>
                                        </el-form-item>
                                        </el-col>
                                    <el-col class="line" :span="2">—</el-col>
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="basic.end_time"
                                                            placeholder="结束时间点" format="HH:mm" value-format="HH:mm" >
                                            </el-time-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                </el-form-item>
                                <el-form-item label="采集周期" prop="period">
                                            <el-input type="number" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="basic.period" style="width: 96%"
                                                      placeholder="请输入采集周期(秒)"></el-input>
                                        </el-form-item>
                            </el-form>
                        </div></el-col>
                        <el-col :span="12"><div class="grid-content bg-purple-light">
                            <div style="padding: 0px 45% 0px 45%">
                                <h2>预览</h2>
                            </div>
                            <div style="text-align:center;width: 100%;height: 40%;background-color: whitesmoke; position: relative" id="text1">

                                <div id = "text2" style="position:absolute;left:230px;top:150px;">
                                </div>
                            </div>
                            <div style="padding: 0px 20%">
                                <div style="height: 20px"></div>
                                <el-button type="primary" @click="basic_test">采集测试</el-button>
                            </div>
                            <div style="padding: 0px 20%">
                                <div style="height: 20px"></div>
                            </div>
                        </div></el-col>
                    </el-row>
                </el-tab-pane>
                <!-- 基本单元 end-->

                <!-- 图表单元 start-->
                <el-tab-pane :disabled="disabled3" label="图表监控项" name="second">
                    <el-row>
                        <el-col :span="12"><div class="grid-content bg-purple">
                            <el-form :model="chart" :rules="rules2" ref="chart" label-width="100px">
                                <el-form-item label="字号" prop="font_size">
                                    <el-select v-model="chart.font_size" placeholder="请选择字号">
                                        <el-option v-for="i in font_size_range" :label=i :value=i></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="高Ⅹ宽" required style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item prop="height">
                                            <el-input type="number" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="chart.height"
                                                      placeholder="请输入高度" @change="echart_height"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col class="line" :span="2">Ⅹ</el-col>
                                    <el-col :span="11">
                                        <el-form-item prop="width">
                                              <el-input type="number" v-model.number="numberValidateForm.age"
                                                        auto-complete="off" v-model="chart.width"
                                                        placeholder="请输入宽度" @change="echart_width"></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                <el-form-item label="图标类型" prop="gather_params">
                                    <el-select v-model="chart.gather_params" @change="show_chart" placeholder="请选择图表类型">
                                        <el-option label="折线图" value="折线图"></el-option>
                                        <el-option label="柱状图" value="柱状图"></el-option>
                                        <el-option label="饼图" value="饼图"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="显示内容" style="width: 96%" prop="contents">
                                    <el-input type="textarea" v-model="chart.contents"
                                              placeholder="上证指数:3000  深证指数:3000" @change="show_content"></el-input>
                                </el-form-item>
                                <el-form-item label="连接数据库">
                                    <el-select v-model="chart.params" placeholder="请选择数据库">
                                        <el-option v-for="i in sites1" :label="i.label" :value="i.value"></el-option>

                                    </el-select>
                                </el-form-item>
                                <el-form-item label="图表采集规则" style="width: 96%">
                                    <el-input v-model="chart.gather_rule" placeholder="select * from tb_hq"
                                              type="textarea"></el-input>
                                </el-form-item>
                                <el-form-item label="采集时间段:" style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="chart.start_time"
                                                            placeholder="开始时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                        </el-col>
                                    <el-col class="line" :span="2">—</el-col>
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="chart.end_time"
                                                            placeholder="结束时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                <el-form-item label="采集周期" prop="period">
                                            <el-input type="number" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="chart.period" style="width: 96%"
                                                      placeholder="请输入采集周期(秒)"></el-input>
                                </el-form-item>
                            </el-form>
                        </div></el-col>
                        <el-col :span="12">
                            <div class="grid-content bg-purple-light">
                                <div style="padding: 0px 45% 0px 45%">
                                    <h2>预览</h2>
                                </div>
                                <div style="text-align:center;width: 100%;height: 40%;">
                                    <div id="maintenanceIndex">
                                        <el-row>
                                            <el-col :span="24">
                                                <el-card shadow="always" class="box-card">
                                                    <div slot="header" class="clearfix">
                                                        <span class="maintenanceHeader">{{ chart_content }}</span>
                                                    </div>
                                                    <div id="maintenancePie"></div>
                                                </el-card>
                                            </el-col>
                                        </el-row>
                                    </div>
                                </div>
                                <div style="padding: 0px 20%">
                                    <div style="height: 20px"></div>
                                    <el-button type="primary" v-on:click="chart_get_test">采集测试</el-button>
                                </div>
                            </div>
                        </el-col>
                    </el-row>
                </el-tab-pane>
                <!-- 图表单元 end-->

                <!-- 作业单元 start-->
                <el-tab-pane :disabled="disabled4" label="作业监控项" name="third">
                    <el-row>
                        <el-col :span="12"><div class="grid-content bg-purple">
                            <el-form :model="job" :rules="rules3" ref="job" label-width="100px">
                                <el-form-item label="字号" prop="font_size">
                                    <el-select v-model="job.font_size" @change="change_job_fontSize" placeholder="请选择字号">
                                        <el-option v-for="i in font_size_range" :label=i :value=i></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="高Ⅹ宽" required style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item prop="height">
                                            <el-input type="number" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="job.height"
                                                      placeholder="请输入高度" @change="change_job_height"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col class="line" :span="2">Ⅹ</el-col>
                                    <el-col :span="11">
                                        <el-form-item prop="width">
                                              <el-input type="number" v-model.number="numberValidateForm.age"
                                                        auto-complete="off" v-model="job.width"
                                                        placeholder="请输入宽度" @change="change_job_width"></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                <el-form-item label="显示内容" style="width: 96%" prop="contents">
                                    <el-input type="textarea" v-model="job.contents"
                                              placeholder="上证指数:3000  深证指数:3000" @change="change_job_contents"></el-input>
                                </el-form-item>
                                <el-form-item label="作业模板" prop="gather_params">
                                    <el-select v-model="job.gather_rule" placeholder="请选择作业模板">
                                        <el-option v-for="i in job2" :label="i.name" :value="i.id"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="脚本参数" style="width: 96%">
                                    <el-input v-model="job.gather_params" placeholder="多个参数空格分开"></el-input>
                                </el-form-item>
                                <el-form-item label="执行服务器" style="width: 96%">
                                    <el-input v-model="job.params" placeholder="请输入服务器地址"></el-input>
                                </el-form-item>
                                <el-form-item label="采集时间段:" style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="job.start_time"
                                                            placeholder="开始时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                        </el-col>
                                    <el-col class="line" :span="2">—</el-col>
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="job.end_time"
                                                            placeholder="结束时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                 <el-form-item label="采集周期" prop="period">
                                            <el-input type="number" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="job.period" style="width: 96%"
                                                      placeholder="请输入采集周期(秒)"></el-input>
                                </el-form-item>
                            </el-form>
                        </div></el-col>
                        <el-col :span="12"><div class="grid-content bg-purple-light">
                            <div style="padding: 0px 45% 0px 45%">
                                <h2>预览</h2>
                            </div>
                            <div style="text-align:center;width: 100%;min-height:40%;height: auto;background-color: whitesmoke;">
                                <div style="height: 60px"></div>
                                <div id="job_text" style="max-width: 100%; background: beige;margin: auto;padding-top: 20px;">
                                    <div class="unexecuted" style="color: grey;display: block">
                                        <h1>作业未执行</h1>
                                        <i class="el-icon-error" style="color: grey;font-size: 30px;margin-top: 20px;"></i>
                                    </div>
                                    <div class="error" style="color: red;display: none">
                                        <h1>作业执行失败</h1>
                                        <i class="el-icon-error" style="color: red;font-size: 30px;margin-top: 20px;"></i>
                                    </div>
                                    <div class="success" style="color: green;display: none">
                                        <h1>作业执行成功</h1>
                                        <i class="el-icon-success" style="color: green;font-size: 30px;margin-top: 20px;"></i>
                                    </div>
                                    <div class="loading" style="color: orange;display: none">
                                        <h1>正在执行</h1>
                                        <i class="el-icon-loading" style="color: orange;font-size: 30px;margin-top: 20px;"></i>
                                    </div>
                                </div>

                            </div>
                            <div style="padding: 0px 10%">
                                <div style="height: 20px"></div>
                                <el-button type="primary" :disabled="disabled1" v-on:click="job_test">采集测试</el-button>
                                <el-checkbox v-model="checked1" @change="change2" >启动脚本</el-checkbox>
                                <div :style="{ display: zuoye }">
                                    <el-alert title="启动作业可能会对系统造成不可逆的变更，请谨慎勾选此项！" type="warning" show-icon show-icon
                                              true-label="1" false-label="0"></el-alert>
                                </div>
                            </div>
                        </div></el-col>
                    </el-row>
                </el-tab-pane>
                <!-- 作业单元 end-->

                <!-- 流程单元 start-->
                <el-tab-pane :disabled="disabled5" label="流程监控项" name="fourth">
                    <el-row>
                        <el-col :span="12"><div class="grid-content bg-purple">
                            <el-form :model="flow" :rules="rules4" ref="flow" label-width="100px">
                                <el-form-item label="流程模板" prop="gather_params">
                                    <el-select v-model="flow.gather_rule" placeholder="请选择模板" @change="flow_change"	>
                                        <el-option v-for="i in flow2" :label="i.flow_name" :value="i.id"></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="节点">
                                        <el-select v-model="flow.node_name" placeholder="请选择节点">
                                          <el-option v-for="i in activities_node_name" :label="i.name" :value="i.name"></el-option>
                                        </el-select>
                                 </el-form-item>


                                  <el-form-item label="采集时间段:" style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="activities_node_time.start_time"
                                                            placeholder="开始时间点" @change="Rendering_start_time" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                        </el-col>
                                    <el-col class="line" :span="2">—</el-col>
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="activities_node_time.end_time"
                                                            placeholder="结束时间点" @change="Rendering_end_time" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>

                                <el-form-item v-for="i in constants" :label="i.name" style="width: 96%">
                                    <el-input v-model="i.value" placeholder="请输入参数"></el-input>
                                </el-form-item>


                                <el-form-item label="字号" prop="font_size">
                                    <el-select v-model="flow.font_size" placeholder="请选择字号" @change="font_size">
                                        <el-option v-for="i in font_size_range" :label=i :value=i></el-option>
                                    </el-select>
                                </el-form-item>
                                <el-form-item label="高Ⅹ宽" required style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item prop="height">
                                            <el-input type="number" v-model.number="numberValidateForm.age" auto-complete="off" v-model="flow.height" placeholder="请输入高度" @change="flow_height"></el-input>
                                        </el-form-item>
                                    </el-col>
                                    <el-col class="line" :span="2">Ⅹ</el-col>
                                    <el-col :span="11">
                                        <el-form-item prop="width">
                                              <el-input type="number" v-model.number="numberValidateForm.age"
                                                        auto-complete="off" v-model="flow.width" placeholder="请输入宽度"
                                                        @change="flow_width"></el-input>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>

                                <div v-if="flow.gather_params.id === '1'">
                                <el-form-item label="节点周期:" style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="flow.start_time"
                                                            placeholder="开始时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                        </el-col>
                                    <el-col class="line" :span="2">—</el-col>
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="flow.end_time"
                                                            placeholder="结束时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                </div>
                                <div v-if="flow.gather_rule === '1'">
                                <el-form-item label="节点周期:" style="width: 96%">
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="flow.start_time"
                                                            placeholder="开始时间点1" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                        </el-col>
                                    <el-col class="line" :span="2">—</el-col>
                                    <el-col :span="11">
                                        <el-form-item>
                                            <el-time-picker style="width: 96%" v-model="flow.end_time"
                                                            placeholder="结束时间点" format="HH:mm" value-format="HH:mm">
                                            </el-time-picker>
                                        </el-form-item>
                                    </el-col>
                                </el-form-item>
                                </div>
                                 <el-form-item label="采集周期" prop="period">
                                            <el-input type="number" id="period" v-model.number="numberValidateForm.age"
                                                      auto-complete="off" v-model="flow.period" style="width: 96%"
                                                      placeholder="请输入采集周期(秒)"></el-input>
                                </el-form-item>
                            </el-form>
                        </div></el-col>
                        <el-col :span="12"><div class="grid-content bg-purple-light">
                            <div style="padding: 0px 45% 0px 45%">
                                <h2>预览</h2>
                            </div>
                            <div id="flow_canvas" style="text-align:center;width: 100%;height: 40%;background-color: whitesmoke;">
                                <div id="flow1" class="clearfix workflow-box" style="width: 100%;position: relative;">

                                        <div class="workflow-canvas" style="margin-left: 0px;padding-left: 0px">
                                            <!-- 画布模板 start -->
                                            <div class="jtk-content">
                                                <div class="jtk-demo-canvas canvas-wide jtk-surface jtk-surface-nopan"
                                                     id="canvas" style="height:500px">
                                                    <!-- 流程 -->
                                                </div>
                                            </div>
                                            <!-- 画布模板 end -->

                                        </div>

    <!-- template 模板-->
                                        <div class="jtk-delete jtk-none ">删除节点</div>
                                        <div id="template" class="jtk-none">
                                            <div class="jtk-window jtk-node workfolw-node start-node" id="{charts}"
                                                 data-type="EmptyEndEvent">
                                                <div class="node-wrapper">
                                                    <div class="node-icon-start">
                                                        <i class="bk-icon icon-star-shape"></i>
                                                    </div>
                                                </div>
                                            </div>
                                             <div class="jtk-window jtk-node workfolw-node start-node" id="{charts}"
                                                  data-type="EmptyStartEvent">
                                                <div class="node-wrapper">
                                                    <div class="node-icon-start">
                                                        <i class="bk-icon icon-star-shape"></i>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="jtk-window jtk-node workfolw-node database-node" id="{charts}"
                                                 data-type="ServiceActivity">
                                                <div class="node-wrapper">
                                                    <div class="node-content" style="position: relative">
                                                        <div class="start_time" style="position: absolute;width: 70px;height: 20px;top: -26px;left: 0px;"></div>
                                                        <div class="end_time" style="position: absolute;width: 70px;height: 20px;top: -26px;right: 0px;"></div>
                                                        <p class="node-title"></p>
                                                    </div>
                                                    <div class="node-icon">
                                                        <i class="bk-icon icon-data"></i>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="jtk-window jtk-node workfolw-node cog-node" id="{charts}"
                                                 data-type="dataCog">
                                                <div class="node-wrapper">
                                                    <div class="node-content">
                                                        <p class="node-title"></p>
                                                    </div>
                                                    <div class="node-icon">
                                                        <i class="bk-icon icon-cog"></i>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="jtk-window jtk-node workfolw-node filter-node" id="{charts}"
                                                 data-type="dataFilter">
                                                <div class="node-wrapper">
                                                    <div class="node-content">
                                                        <p class="node-title"></p>
                                                    </div>
                                                    <div class="node-icon">
                                                        <i class="bk-icon icon-circle"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                            <div style="padding: 0px 10%">
                                <div style="height: 20px"></div>
                                <el-button type="primary" v-on:click="canvas_new" :disabled="disabled1">采集测试</el-button>
                                <el-checkbox v-model="checked2" @change="change3">启动流程</el-checkbox>
                                <div :style="{ display: liucheng }">
                                    <el-alert title="启动流程可能会对系统造成不可逆的变更，请谨慎勾选此项！" type="warning" show-icon
                                              true-label="1" false-label="0"></el-alert>
                                </div>
                            </div>
                        </div></el-col>
                    </el-row>
                </el-tab-pane>
                <!-- 基本单元 end-->
            </el-tabs>
        </span>
        <span slot="footer" class="dialog-footer">
            <el-button @click="centerDialogVisible = false">取 消</el-button>
            <el-button type="primary" v-on:click="pefFrom">保 存</el-button>
        </span>
    </el-dialog>
    <!-- 对话框 end-->
</div>
</body>


<script>
    //csrf验证
    axios.interceptors.request.use((config) => {
        config.headers['X-Requested-With'] = 'XMLHttpRequest';
        let regex = /.*csrftoken=([^;.]*).*$/; // 用于从cookie中匹配 csrftoken值
        config.headers['X-CSRFToken'] = document.cookie.match(regex) === null ? null : document.cookie.match(regex)[1];
        return config
    });
    var vm = new Vue({
        el: '#app',
        data: {
            constants:'',
            location : '',
            line:'',
            old_html:'',
            msg1:'',
            sql_id:'',
            template_list:{
                name:'',
                id:''
            },
            add_pamas:0,                                        //新增编辑判断
            font_size_range:[20,22,24,26,28,30,32,34,36,38,40],   //字体大小
            job2: [],                                   //作业模板
            flow2: [],                                  //流程模板
            activities_node_name:[],                    //节点名称
            activities_node_time:{                      //节点时间
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
            },
            page_count: 100,                            //总页码数
            page: 1,                                    //分页页码数
            sites: [],                                  //table内容
            sites1:[],
            contents: '',                               //搜索输入框内容
            checked1: false,                           //作业启动选框
            checked2: false,                           //流程启动选框
            disabled1: false,
            disabled2: false,                            //基本单元
            disabled3: false,                            //图表单元
            disabled4: false,                            //作业单元
            disabled5: false,                            //流程单元
            caiji1: 'block',
            caiji2: 'none',
            monitor_name: '',                             //单元名称
            unit_id: 0,                                   //单元id
            centerDialogVisible: false,                  //弹窗状态
            sql1: 'block',
            file1: 'none',
            interface1: 'none',
            sql_file_interface: 3,
            server_url: '',
            file_param: '',
            param1: '',
            param2: '',
            zuoye: 'none',
            liucheng: 'none',
            result_data: {},                           //传递新增数据
            monitor_type: 'first',                     //单元类型
            basic: {                                   //基本单元
                monitor_name: '',                      //单元名称
                monitor_type: '',                      //单元类型
                font_size: '20',                         //字号
                height: '20',                            //高度
                width: '0',                             //宽度
                start_time: '',                        //开始时间
                end_time: '',                          //结束时间
                period: '10',                            //采集周期
                params: '',                            //监控参数
                status: '',                            //监控状态
                contents: '',                          //显示内容
                gather_rule: '',                       //采集规则
                gather_params: 'sql',                  //采集参数
            },
            rules1: {
                font_size: [
                    {required: true, message: '请选择字号', trigger: 'change'}
                ],
                height: [
                    {required: true, message: '请输入高度', trigger: 'blur'}
                ],
                width: [
                    {required: true, message: '请输入宽度', trigger: 'blur'}
                ],
                contents: [
                    {required: true, message: '请输入内容', trigger: 'blur'}
                ],
                period: [
                    {required: true, message: '请输入采集周期(以秒为单位)', trigger: 'blur'}
                ],

            },
            chart: {                                //图表单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '20',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '10',                          //采集周期
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //采集规则
                gather_params: '',                   //节点
                params: '',                          //监控参数
            },
            rules2: {
                font_size: [
                    {required: true, message: '请选择字号', trigger: 'change'}
                ],
                height: [
                    {required: true, message: '请输入高度', trigger: 'blur'}
                ],
                width: [
                    {required: true, message: '请输入宽度', trigger: 'blur'}
                ],
                contents: [
                    {required: true, message: '请输入内容', trigger: 'blur'}
                ],
                gather_params: [
                    {required: true, message: '请选择图片类型', trigger: 'change'}
                ],
                period: [
                    {required: true, message: '请输入采集周期(以秒为单位)', trigger: 'blur'}
                ],
            },
            job: {                                   //作业单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '0',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '10',                          //采集周期
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //NODE_KEY
                gather_params: '',                   //作业模板
                params: '',                         //执行服务器
            },
            rules3: {
                font_size: [
                    {required: true, message: '请选择字号', trigger: 'change'}
                ],
                height: [
                    {required: true, message: '请输入高度', trigger: 'blur'}
                ],
                width: [
                    {required: true, message: '请输入宽度', trigger: 'blur'}
                ],
                contents: [
                    {required: true, message: '请输入内容', trigger: 'blur'}
                ],
                gather_params: [
                    {required: true, message: '请选择作业模板', trigger: 'change'}
                ],
                period: [
                    {required: true, message: '请输入采集周期(以秒为单位)', trigger: 'blur'}
                ],
            },
            flow: {                                //流程单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '0',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '10',                          //采集周期
                params: '',                         //监控参数
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //采集规则
                gather_params: '',                   //流程模板
                node_name:''
            },
            rules4: {
                font_size: [
                    {required: true, message: '请选择字号', trigger: 'change'}
                ],
                height: [
                    {required: true, message: '请输入高度', trigger: 'blur'}
                ],
                width: [
                    {required: true, message: '请输入宽度', trigger: 'blur'}
                ],
                gather_params: [
                    {required: true, message: '请选择流程模板', trigger: 'change'}
                ],
                period: [
                    {required: true, message: '请输入采集周期(以秒为单位)', trigger: 'blur'}
                ]
            },
            basic1: {                                //基本单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '0',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '10',                          //采集周期
                params: '',                         //监控参数
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //采集规则
                gather_params: 'sql',                   //采集参数
            },
            chart1: {                                //图表单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '0',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '10',                          //采集周期
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //采集规则
                gather_params: '',                   //节点
                params: '',                          //监控参数
            },
            job1: {                                   //作业单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '0',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '10',                          //采集周期
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //NODE_KEY
                gather_params: '',                   //作业模板
                params: '',                         //执行服务器
            },
            flow7: {                                //流程单元
                monitor_name: '',                    //单元名称
                monitor_type: '',                    //单元类型
                font_size: '20',                       //字号
                height: '20',                          //高度
                width: '0',                            //宽度
                start_time: '',                      //开始时间
                end_time: '',                        //结束时间
                period: '',                          //采集周期
                params: '10',                         //监控参数
                status: '',                          //监控状态
                contents: '',                        //显示内容
                gather_rule: '',                     //采集规则
                gather_params: '',                   //流程模板
            },
            myChart: null,
            chart_content:'',
            chartData:'',
            person_count:'',
        },
        methods: {
            basic_size(){
              $("#text2").find("*").css("font-size",this.basic.font_size)
            },
            basic_height(){
                $('#text2').css('top',this.basic.height)
            },
            basic_width(){
                $("#text2").css("left",this.basic.width)
            },
            sycontent(){
                let tempcontents = vm.basic.contents
                $("#text2").html("")
                $("#text2").append("<div>"+tempcontents+"</div>")
                if(vm.basic.contents.indexOf("#") > -1 && vm.basic.contents.indexOf('@') == -1){
                    var temp1 = tempcontents.split("#");
                    var temp2=[];
                    var temp3=[];
                    var temp4=[];
                    var str=[];
                    for(var i=1;i<temp1.length;i=i+2){
                        temp2.push(temp1[i]);
                    }
                    for(var i=0;i<temp2.length;i++){
                        temp3.push(temp2[i].split("="))
                    }
                    for(var i=0;i<temp3.length;i++){
                        temp4.push(temp3[i][1])
                    }
                    for(i=0;i<temp2.length;i++){
                        str[i]='#'+temp2[i]+'#'
                    }
                    $("#text2").html("")
                     for (var i = 0, j = 0; i < temp1.length; i = i + 2, j++) {
                         if(j<temp4.length){
                             $("#text2").append("<div>" + temp1[i] + temp4[j]+ "</div>");
                         }
                         else{
                              $("#text2").append("<div>" + temp1[i]+ "</div>");
                         }
                     }
                  }
                if(vm.basic.contents.indexOf('@') > -1 && vm.basic.contents.indexOf("#") == -1){
                    var icon1 = tempcontents.split("@");
                    var icon2=[];
                    var icon3=[];
                    var icon4=[-2];
                    var icon=[];
                    for(var i=1;i<icon1.length;i=i+2){
                        icon2.push(icon1[i]);
                    }
                    for(var i=0;i<icon2.length;i++){
                        icon3.push(icon2[i].split("="));
                    }
                    for(var i=0;i<icon3.length;i++){
                        icon4.pop();
                        icon4.push(icon3[i][1]);
                    }
                    $("#text2").html("")
                    $("#text2").append("<div class = \"asd\">"+icon1[0]+"</div>");
                    if(icon4 ){
                        icon4.push("-2")
                     }
                    if (icon4[0] == 1) {
                         $("#text2").append("<div class=\"circle1\"></div>");
                     }
                     if (icon4[0] == 2) {
                         $("#text2").append("<div class=\"circle2\"></div>");
                     }
                     if (icon4[0] == 0) {
                         $("#text2").append("<div class=\"circle4\"></div>");
                     }
                     if (icon4[0] == -1 || icon4 == -2) {
                         $("#text2").append("<div class=\"circle3\"></div>");
                     }
                 }
                if(vm.basic.contents.indexOf("#") > -1 && vm.basic.contents.indexOf('@') > -1) {
                    var temp1 = tempcontents.split("#");
                    var temp2 = [];
                    var temp3 = [];
                    var temp4 = [];
                    for (var i = 1; i < temp1.length; i = i + 2) {
                        temp2.push(temp1[i]);
                    }
                    for (var i = 0; i < temp2.length; i++) {
                        temp3.push(temp2[i].split("="))
                    }
                    for (var i = 0; i < temp3.length; i++) {
                        temp4.push(temp3[i][1])
                    }
                    var icon1 = [];
                    var icon2 = [];
                    var icon3 = [];
                    var icon4 = '';
                    var flag2 = 0;
                    for (var i = 0; i < temp1.length; i = i + 2) {
                        if (temp1[i].indexOf("@") > -1) {
                            icon1 = temp1[i].split("@")
                            flag2 = i
                            for (var k = 0; k < icon1.length; k++) {
                                icon2.push(icon1[k])
                            }
                        }
                    }
                    icon3 = icon2[1].split("=")
                    icon4 = icon3[1]
                    $("#text2").html("")
                    for (var i = 0, j = 0; i < temp1.length; i = i + 2, j++) {

                        if (i == flag2) {
                            $("#text2").append("<div class=\"asd\">" + icon1[0] + "</div>");
                            if (icon4 == 1) {
                                $("#text2").append("<div class=\"circle1\"></div>");
                            }
                            if (icon4 == 2) {
                                $("#text2").append("<div class=\"circle2\"></div>");
                            }
                            if (icon4 == 0) {
                                $("#text2").append("<div class=\"circle4\"></div>");
                            }
                            if (icon4 == -1 || icon4 == -2) {
                                $("#text2").append("<div class=\"circle3\"></div>");
                            }
                        } else {
                            $("#text2").append("<div>" + temp1[i] + temp4[j] + "</div>");
                        }
                    }
                }
            },
            basic_test(){
                let params = '';
                if (vm.sql_file_interface == 3) {
                     params = vm.sql_id
                }
                if (vm.sql_file_interface == 6  || vm.sql_file_interface == 9) {
                     params = vm.server_url +','+ vm.file_param
                }
                axios({
                    method: 'post',
                    url: '${SITE_URL}monitor/basic_test/',
                    data: {
                        id:vm.unit_id,
                        params:params,
                        gather_rule:vm.basic.gather_rule,
                        gather_params:vm.basic.gather_params,
                    },
                }).then(function (res) {
                    let tempcontents2 = vm.basic.contents
                    $("#text2").html("")
                    $("#text2").append("<div>"+tempcontents2+"</div>")
                    if(vm.basic.contents.indexOf("#") > -1 && vm.basic.contents.indexOf('@') == -1){
                        var temp1 = tempcontents2.split("#");
                        var temp2=[];
                        var temp3=[];
                        var temp4=[];
                        for(var i=1;i<temp1.length;i=i+2){
                            temp2.push(temp1[i]);
                        }
                        for(var i=0;i<temp2.length;i++){
                            temp3.push(temp2[i].split("="))
                        }
                        for(var i=0;i<temp3.length;i++){
                            temp4.push(temp3[i][0])
                        }
                        $("#text2").html("")
                         for (var i = 0, j = 0; i < temp1.length; i = i + 2, j++) {
                             if(j<temp4.length){
                                 $("#text2").append("<div>" + temp1[i] + res.data.message[0][temp4[j]]+ "</div>");
                             }
                             else{
                                  $("#text2").append("<div>" + temp1[i]+ "</div>");
                             }
                         }
                      }
                    if(vm.basic.contents.indexOf('@') > -1 && vm.basic.contents.indexOf("#") == -1){
                        var icon1 = tempcontents2.split("@");
                        var icon2=[];
                        var icon3=[];
                        var icon4='';
                        if(res.data.message[0]['DB_CONNECTION']){
                              icon4=res.data.message[0]['DB_CONNECTION'];
                        }
                        if(res.data.message[0]['URL_CONNECTION']){
                              icon4=res.data.message[0]['URL_CONNECTION'];
                        }
                        if(res.data.message[0]['FILE_EXIST']){
                              icon4=res.data.message[0]['FILE_EXIST'];
                        }
                        $("#text2").html("")
                        $("#text2").append("<div class = \"asd\">"+icon1[0]+"</div>");
                        if (icon4 == 1) {
                             $("#text2").append("<div class=\"circle1\"></div>");
                         }
                         if (icon4 == 2) {
                             $("#text2").append("<div class=\"circle2\"></div>");
                         }
                         if (icon4 == 0) {
                             $("#text2").append("<div class=\"circle3\"></div>");
                         }
                         if (icon4 == -1 || icon4 == -2) {
                             $("#text2").append("<div class=\"circle4\"></div>");
                         }
                     }
                    if(vm.basic.contents.indexOf("#") > -1 && vm.basic.contents.indexOf('@') > -1) {
                        var temp1 = tempcontents2.split("#");
                        var temp2 = [];
                        var temp3 = [];
                        var temp4 = [];
                        for (var i = 1; i < temp1.length; i = i + 2) {
                            temp2.push(temp1[i]);
                        }
                        for (var i = 0; i < temp2.length; i++) {
                            temp3.push(temp2[i].split("="))
                        }
                        for (var i = 0; i < temp3.length; i++) {
                            temp4.push(temp3[i][0])
                        }
                        var icon1 = [];
                        var icon2 = [];
                        var icon3 = [];
                        var icon4 = '';
                        var flag2 = 0;
                        for (var i = 0; i < temp1.length; i = i + 2) {
                            if (temp1[i].indexOf("@") > -1) {
                                icon1 = temp1[i].split("@")
                                flag2 = i
                                for (var k = 0; k < icon1.length; k++) {
                                    icon2.push(icon1[k])
                                }
                            }
                        }
                        icon3 = icon2[1].split("=")
                        if(res.data.message[0]['DB_CONNECTION']){
                              icon4=res.data.message[0]['DB_CONNECTION'];
                        }
                        if(res.data.message[0]['URL_CONNECTION']){
                              icon4=res.data.message[0]['URL_CONNECTION'];
                        }
                        if(res.data.message[0]['FILE_EXIST']){
                              icon4=res.data.message[0]['FILE_EXIST'];
                        }
                        $("#text2").html("")
                        for (var i = 0, j = 0; i < temp1.length; i = i + 2, j++) {
                            if (i == flag2) {
                                $("#text2").append("<div class = \"asd\">"+icon1[0]+"</div>");
                                if (icon4 == 1) {
                                     $("#text2").append("<div class=\"circle1\"></div>");
                                 }
                                 if (icon4 == 2) {
                                     $("#text2").append("<div class=\"circle2\"></div>");
                                 }
                                 if (icon4 == 0) {
                                     $("#text2").append("<div class=\"circle3\"></div>");
                                 }
                                 if (icon4 == -1 || icon4 == -1) {
                                     $("#text2").append("<div class=\"circle4\"></div>");
                                 }
                            } else {
                                $("#text2").append("<div>" + temp1[i] + res.data.message[0][temp4[j]] + "</div>");
                            }
                        }
                     }
                })
            },
            pefFrom() {
                var basic = $('#pane-first').attr('style')
                var chart = $('#pane-second').attr('style')
                var job = $('#pane-third').attr('style')
                var flow = $('#pane-fourth').attr('style')
                if (basic == undefined || basic == "") {
                    vm.submitForm('basic')
                } else if (chart == undefined || chart == "") {
                    vm.submitForm('chart')
                } else if (job == undefined || job == "") {
                    vm.submitForm('job')
                } else if (flow == undefined || flow == "") {
                    vm.submitForm('flow')
                }
            },
            current_change1(value) {
                vm.page = value;
                vm.show()
            },
            //保存按钮
            submitForm(formName) {
                this.$refs[formName].validate((valid) => {
                    if (valid) {
                        vm.edit1()
                    } else {
                        console.log('error submit!!');
                        return false;
                    }
                });
            },
            delete_unit(row) {
                this.$confirm('此操作将永久删除该监控项, 是否继续?', '提示', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning',
                    center: true
                }).then(() => {
                    this.$message({
                            type: 'success',
                            message: '删除成功!',
                        },
                        axios({
                            method: 'post',
                            url: '${SITE_URL}monitor/delete/',
                            data: {
                                unit_id: row.id,
                                monitor_name:row.monitor_name,
                                monitor_type: row.monitor_type,
                            }
                        }).then((res) => {
                            vm.show()
                        }),);
                }).catch(() => {
                    this.$message({
                        type: 'info',
                        message: '已取消删除'
                    });
                });
            },
            show() {
                axios({
                    method: 'post',
                    url: '${SITE_URL}monitor/show/',
                    data: {
                        page: vm.page,
                        limit: 10
                    },
                }).then(function (res) {
                    console.log(res)
                    vm.sites = res.data.results.res_list;
                    vm.page_count = res.data.results.res_list[0].page_count;
                    vm.job2 = res.data.results.job;
                    vm.flow2 = res.data.results.flow;
                })
            },
            select1() {
                vm.centerDialogVisible = false;
                vm.page = 1;
                if (vm.contents == "") {
                    vm.show()
                } else {
                    axios({
                        method: 'post',
                        url: '${SITE_URL}monitor/select/',
                        data: {
                            data: this.contents,
                            page: vm.page,
                            limit: 10
                        }
                    }).then((res) => {
                        vm.sites = res.data.message;
                        vm.page_count = res.data.message[0].page_count;
                    })
                }

            },
            //编辑单元
            edit_unit(row) {
                this.get_db_connections();
                vm.add_pamas = 1;
                vm.centerDialogVisible = true;
                vm.disabled2 = false;
                vm.disabled3 = true;
                vm.disabled4 = true;
                vm.disabled5 = true;
                vm.unit_id = row.id;
                vm.monitor_name = row.monitor_name;
                if (row.monitor_type == '基本单元类型') {
                    vm.monitor_type = 'first';
                    vm.basic.font_size = row.font_size;
                    vm.basic.height = row.height;
                    vm.basic.width = row.width;
                    vm.basic.start_time = row.start_time;
                    vm.basic.end_time = row.end_time;
                    vm.basic.period = row.period;
                    vm.sql_file_interface = row.gather_params;
                    vm.file_param = row.file_param;
                    vm.basic.start_time = row.start_time;
                    vm.basic.end_time = row.end_time;
                    vm.basic.gather_rule = row.gather_rule;
                    vm.basic.contents = row.contents;
                    if (vm.sql_file_interface == 'sql') {
                        vm.sql_file_interface =3;
                        axios({
                            method: 'post',
                            url: '${SITE_URL}db_connection/get_conname/',
                            data:row.params,
                        }).then((res)=> {
                            vm.server_url = res['data']['results']['connname']
                            vm.sql_id = res['data']['results']['id']
                            vm.basic_size();
                            vm.basic_height();
                            vm.basic_width();
                            vm.sycontent();
                            vm.basic_test()
                        }).catch((error) => {
                        alert('拉取数据库失败！')
                        });
                        vm.sql1 = 'block';
                        vm.file1 = 'none';
                        vm.interface1 = 'none';
                        vm.basic.gather_params = 'sql'
                    }
                    if (vm.sql_file_interface == 'file') {
                        vm.sql_file_interface =6;
                        arr=row.params.split(",");
                        vm.server_url = arr[0];
                        vm.file_param = arr[1];
                        vm.typeid = '2';
                        vm.sql1 = 'none';
                        vm.file1 = 'block';
                        vm.interface1 = 'none';
                        vm.basic.gather_params = 'file';
                        vm.basic_size();
                        vm.basic_height();
                        vm.basic_width();
                        vm.sycontent();
                        vm.basic_test()
                    }
                    if (vm.sql_file_interface == 'interface') {
                        vm.sql_file_interface =9;
                        arr=row.params.split(",");
                        vm.server_url = arr[0];
                        vm.file_param = arr[1];
                        vm.typeid = '3';
                        vm.sql1 = 'none';
                        vm.file1 = 'none';
                        vm.interface1 = 'block';
                        vm.basic.gather_params = 'interface';
                        vm.basic_size();
                        vm.basic_height();
                        vm.basic_width();
                        vm.sycontent();
                        vm.basic_test()
                    }
                }
                if (row.monitor_type == '图表单元类型') {
                    vm.disabled2 = true;
                    vm.disabled3 = false;
                    vm.disabled4 = true;
                    vm.disabled5 = true;
                    vm.monitor_type = 'second';
                    vm.chart.font_size = row.font_size;
                    vm.chart.height = row.height;
                    vm.chart.width = row.width;
                    vm.chart.start_time = row.start_time;
                    vm.chart.end_time = row.end_time;
                    vm.chart.period = row.period;
                    vm.chart.gather_params = row.gather_params;
                    vm.chart.contents = row.contents;
                    vm.chart.start_time = row.start_time;
                    vm.chart.end_time = row.end_time;
                    vm.chart.gather_rule = row.gather_rule;
                    axios({
                            method: 'post',
                            url: '${SITE_URL}db_connection/get_conname/',
                            data:row.params,
                        }).then((res)=> {
                            vm.chart.params = res['data']['results']
                        }).catch((error) => {
                        alert('拉取数据库失败！')
                        });
                }
                if (row.monitor_type == '作业单元类型') {
                    vm.disabled2 = true;
                    vm.disabled3 = true;
                    vm.disabled4 = false;
                    vm.disabled5 = true;
                    vm.monitor_type = 'third';
                    vm.job.font_size = row.font_size;
                    vm.job.height = row.height;
                    vm.job.width = row.width;
                    vm.job.start_time = row.start_time;
                    vm.job.end_time = row.end_time;
                    vm.job.period = row.period;
                    vm.job.contents = row.contents;
                    vm.job.gather_rule = row.gather_rule;
                    vm.job.gather_params = row.gather_params;
                    vm.job.params = row.params;
                }
                if (row.monitor_type == '流程单元类型') {
                    vm.disabled2 = true;
                    vm.disabled3 = true;
                    vm.disabled4 = true;
                    vm.disabled5 = false;
                    vm.monitor_type = 'fourth';
                    vm.flow.font_size = row.font_size;
                    vm.flow.height = row.height;
                    vm.flow.width = row.width;
                    vm.flow.start_time = row.start_time;
                    vm.flow.end_time = row.end_time;
                    vm.flow.period = row.period
                }
            },
            //保存数据处理
            edit1() {
                vm.centerDialogVisible = false;
                if (vm.monitor_type == 'first') {
                    vm.result_data = vm.basic;
                    if (vm.file_param == '') {
                        vm.basic.params = vm.server_url
                    } else {
                        vm.basic.params = vm.server_url + ',' + vm.file_param;
                    }
                    vm.basic.monitor_name = vm.monitor_name;
                    vm.basic.monitor_type = vm.monitor_type
                } else if (vm.monitor_type == 'second') {
                    vm.result_data = vm.chart;
                    vm.chart.monitor_name = vm.monitor_name;
                    vm.chart.monitor_type = vm.monitor_type
                } else if (vm.monitor_type == 'third') {
                    vm.result_data = vm.job;
                    vm.job.monitor_name = vm.monitor_name;
                    vm.job.monitor_type = vm.monitor_type
                } else if (vm.monitor_type == 'fourth') {
                    vm.result_data = vm.flow;
                    vm.flow.monitor_name = vm.monitor_name;
                    vm.flow.monitor_type = vm.monitor_type;
                    vm.flow.params = vm.param1 + '+' + vm.param2
                }

                if (vm.unit_id > 0) {
                    axios({
                        method: 'post',
                        url: '${SITE_URL}monitor/edit/',
                        data: {
                            data: vm.result_data,
                            monitor_type: vm.monitor_type,
                            monitor_name: vm.monitor_name,
                            unit_id: vm.unit_id,
                        }
                    }).then((res) => {
                        vm.show()
                    }).catch((error) => {
                        alert('修改失败！')
                    });
                } else {
                    axios({
                        method: 'post',
                        url: '${SITE_URL}monitor/add/',
                        data: {
                            data: vm.result_data,
                            monitor_type: vm.monitor_type,
                            monitor_name: vm.monitor_name
                        },
                    }).then((res) => {
                        if (res['data']['code'] == 1)
                            alert('保存失败！');
                        else alert('保存成功！');
                        vm.show()
                    }).catch((error) => {
                        alert('保存失败！')
                    });
                }
            },
            flow_change(value){
                vm.node_name(value)
                vm.location =''
                vm.line=''
                axios({
                    method:'post',
                    url:'${SITE_URL}monitor/flow_change/',
                    data: {
                        template_id:value
                    }
                }).then(function (res) {
                    {
                        console.log(res.data.template_id[0])
                        vm.template_list.id=res.data.template_id[0].id
                        vm.template_list.name=res.data.template_id[0].name
                        vm.constants = res.data.constants
                        var aa=" <div id=\"flow1\" class=\"clearfix workflow-box\" style=\"width: 100%;position: relative;\">\n" +
                            "\n" +
                            "                                        <div class=\"workflow-canvas\" style=\"margin-left: 0px;padding-left: 0px\">\n" +
                            "                                            <!-- 画布模板 start -->\n" +
                            "                                            <div class=\"jtk-content\">\n" +
                            "                                                <div class=\"jtk-demo-canvas canvas-wide jtk-surface jtk-surface-nopan\"\n" +
                            "                                                     id=\"canvas\" style=\"height:500px\">\n" +
                            "                                                    <!-- 流程 -->\n" +
                            "                                                </div>\n" +
                            "                                            </div>\n" +
                            "                                            <!-- 画布模板 end -->\n" +
                            "\n" +
                            "                                        </div>\n" +
                            "\n" +
                            "    <!-- template 模板-->\n" +
                            "                                        <div class=\"jtk-delete jtk-none \">删除节点</div>\n" +
                            "                                        <div id=\"template\" class=\"jtk-none\">\n" +
                            "                                            <div class=\"jtk-window jtk-node workfolw-node start-node\" id=\"{charts}\"\n" +
                            "                                                 data-type=\"EmptyEndEvent\">\n" +
                            "                                                <div class=\"node-wrapper\">\n" +
                            "                                                    <div class=\"node-icon-start\">\n" +
                            "                                                        <i class=\"bk-icon icon-star-shape\"></i>\n" +
                            "                                                    </div>\n" +
                            "                                                </div>\n" +
                            "                                            </div>\n" +
                            "                                             <div class=\"jtk-window jtk-node workfolw-node start-node\" id=\"{charts}\"\n" +
                            "                                                  data-type=\"EmptyStartEvent\">\n" +
                            "                                                <div class=\"node-wrapper\">\n" +
                            "                                                    <div class=\"node-icon-start\">\n" +
                            "                                                        <i class=\"bk-icon icon-star-shape\"></i>\n" +
                            "                                                    </div>\n" +
                            "                                                </div>\n" +
                            "                                            </div>\n" +
                            "                                            <div class=\"jtk-window jtk-node workfolw-node database-node\" id=\"{charts}\"\n" +
                            "                                                 data-type=\"ServiceActivity\">\n" +
                            "                                                <div class=\"node-wrapper\">\n" +
                            "                                                    <div class=\"node-content\" style=\"position: relative\">\n" +
                            "                                                        <div class=\"start_time\" style=\"position: absolute;width: 70px;height: 20px;top: -26px;left: 0px;\"></div>\n" +
                            "                                                        <div class=\"end_time\" style=\"position: absolute;width: 70px;height: 20px;top: -26px;right: 0px;\"></div>\n" +
                            "                                                        <p class=\"node-title\"></p>\n" +
                            "                                                    </div>\n" +
                            "                                                    <div class=\"node-icon\">\n" +
                            "                                                        <i class=\"bk-icon icon-data\"></i>\n" +
                            "                                                    </div>\n" +
                            "                                                </div>\n" +
                            "                                            </div>\n" +
                            "\n" +
                            "                                            <div class=\"jtk-window jtk-node workfolw-node cog-node\" id=\"{charts}\"\n" +
                            "                                                 data-type=\"dataCog\">\n" +
                            "                                                <div class=\"node-wrapper\">\n" +
                            "                                                    <div class=\"node-content\">\n" +
                            "                                                        <p class=\"node-title\"></p>\n" +
                            "                                                    </div>\n" +
                            "                                                    <div class=\"node-icon\">\n" +
                            "                                                        <i class=\"bk-icon icon-cog\"></i>\n" +
                            "                                                    </div>\n" +
                            "                                                </div>\n" +
                            "                                            </div>\n" +
                            "\n" +
                            "                                            <div class=\"jtk-window jtk-node workfolw-node filter-node\" id=\"{charts}\"\n" +
                            "                                                 data-type=\"dataFilter\">\n" +
                            "                                                <div class=\"node-wrapper\">\n" +
                            "                                                    <div class=\"node-content\">\n" +
                            "                                                        <p class=\"node-title\"></p>\n" +
                            "                                                    </div>\n" +
                            "                                                    <div class=\"node-icon\">\n" +
                            "                                                        <i class=\"bk-icon icon-circle\"></i>\n" +
                            "                                                    </div>\n" +
                            "                                                </div>\n" +
                            "                                            </div>\n" +
                            "                                        </div>\n" +
                            "                                    </div>"
                        $('#flow_canvas').html(aa)
                        vm.location = res.data.activities
                        vm.line = res.data.flows
                        //显示流程单元中的预览图
                        $('#flow1').dataflow({

                            el: '.tool', //流程拖动源
                            canvas: '#canvas', //画布
                            arrowWidth: 8,
                            arrowHeight: 10,
                            template: '#template',
                            data:
                                {
                                    "line": vm.line, "location": vm.location

                                }
                        });

                        $('.node-icon').css('top','-7px')
                        let old_html  = $('#canvas').html()
                        $('#canvas').html('<div style="transform: scale(0.65)">'+old_html+'</div>')
                    }
                })

            },
            node_name(value){
                axios({
                    method:'post',
                    url:'${SITE_URL}monitor/node_name/',
                    data:{
                        'id':value
                    }
                }).then(function (res) {
                    vm.activities_node_name=res.data.activities

                })
            },
            Rendering_start_time(){
                $('p:contains('+vm.flow.node_name+')').parent().find('.start_time').text(vm.activities_node_time.start_time)
            },
             Rendering_end_time(){
                $('p:contains('+vm.flow.node_name+')').parent().find('.end_time').text(vm.activities_node_time.end_time)
            },
            canvas_new() {
                if(vm.liucheng == 'block'){
                    var node_id=''
                    var start_time=''
                    var end_time=''
                    var node_times=[]
                    for(var i=2;i<=vm.location.length-1;i++){
                            var node_time={}
                            node_time.node_id= vm.location[i].id ,
                            node_time.starttime= $('#' + vm.location[i].id + '').find('.start_time').text(),
                             node_time.endtime= $('#' + vm.location[i].id + '').find('.end_time').text()
                            node_time.node_name=   $('#' + vm.location[i].id + '').find('.node-title').text()
                            node_times.push(node_time)

                    }
                    var period = $('#period').val()
                    var template_list = vm.template_list
                    axios({
                        method: 'post',
                        url: '${SITE_URL}monitor/start_flow_task/',
                        data: {
                            'period': period,
                            'template_list': template_list,
                            'node_times': node_times,
                            'monitor_name':vm.monitor_name,
                            'monitor_type':vm.monitor_type,
                            'constants':vm.constants
                        }
                    }).then(function (res) {
                        axios({
                            method:'post',
                            url:'${SITE_URL}monitor/node_state/',
                            data:{
                                'item_id':res.data
                            }
                        }).then(function (res) {
                            console.log(res)
                        })
                    })
                }else if(vm.liucheng == 'none'){

                    var period = $('#period').val()
                    var template_list = vm.template_list

                    axios({
                        method: 'post',
                        url: '${SITE_URL}monitor/flow_gather_test/',
                        data: {}
                    }).then(function () {

                    })
                }

            },
            add_unit(row) {                         //新增单元
                     {   if (vm.add_pamas == 1) {
                         vm.Initialization();
                        }
                         vm.add_pamas = 0;
                         vm.monitor_name = '';
                         vm.disabled2 = false;
                         vm.disabled3 = false;
                         vm.disabled4 = false;
                         vm.disabled5 = false;
                         vm.monitor_type = 'first';
                         vm.unit_id = row;
                         vm.centerDialogVisible = true;
                         this.get_db_connections();
                    };
            },
            del() {
                vm.edit(0)
            },
            change1(value) {
                if (value == 3) {
                    vm.sql1 = 'block';
                    vm.file1 = 'none';
                    vm.interface1 = 'none';
                    vm.server_url = '';
                    vm.file_param = '';
                    vm.basic.gather_rule = '';
                    vm.basic.gather_params = 'sql'
                } else if (value == 6) {
                    vm.typeid = '2';
                    vm.sql1 = 'none';
                    vm.file1 = 'block';
                    vm.interface1 = 'none';
                    vm.server_url = '';
                    vm.file_param = '';
                    vm.basic.gather_rule = '';
                    vm.basic.gather_params = 'file';
                } else if (value == 9) {
                    vm.typeid = '3';
                    vm.sql1 = 'none';
                    vm.file1 = 'none';
                    vm.interface1 = 'block';
                    vm.server_url = '';
                    vm.file_param = '';
                    vm.basic.gather_rule = '';
                    vm.basic.gather_params = 'interface';
                }
            },
            change2(value) {
                if (value == 1) {
                    vm.zuoye = 'block';
                } else {
                    vm.zuoye = 'none';
                }
            },
            change3(value) {
                if (value == 1) {
                    vm.liucheng = 'block';
                } else {
                    vm.liucheng = 'none';
                }
            },
            change_job_fontSize(){       //修改作业单元中预览字体
                $('#job_text').find("*").css('font-size',this.job.font_size);
            },
            change_job_height(){       //修改作业单元中预览高度
                $('#job_text').css('height',this.job.height);
            },
            change_job_width(){       //修改作业单元中预览宽度
                $('#job_text').css('width',this.job.width);
            },
            change_job_contents(){       //作业单元显示内容
                let contents=vm.job.contents;
                let str = contents.split('@')[1].split('=')[1];
                switch (str) {
                    case '0':
                        $('.unexecuted').css('display','block');
                        $('.success').css('display','none');
                        $('.error').css('display','none');
                        $('.loading').css('display','none');
                        break;
                    case '1':
                        $('.unexecuted').css('display','none');
                        $('.success').css('display','block');
                        $('.error').css('display','none');
                        $('.loading').css('display','none');
                        break;
                    case '2':
                        $('.unexecuted').css('display','none');
                        $('.success').css('display','none');
                        $('.error').css('display','none');
                        $('.loading').css('display','block');
                        break;
                    case '-1':
                        $('.unexecuted').css('display','none');
                        $('.success').css('display','none');
                        $('.error').css('display','block');
                        $('.loading').css('display','none');
                        break;
                    default:
                        $('.unexecuted').css('display','block');
                        $('.success').css('display','none');
                        $('.error').css('display','none');
                        $('.loading').css('display','none');
                }
            },
            job_test() {
                vm.disabled1 = true;
                setTimeout(function () {
                    vm.disabled1 = false;
                }, 3000);
                $('.unexecuted').css('display','none');
                $('.success').css('display','none');
                $('.error').css('display','none');
                $('.loading').css('display','block');
                axios({
                    url:'${SITE_URL}monitor/job_test/',
                    method:'post',
                    data: {

                        'gather_params': vm.job.gather_params,
                        'job_id': vm.job.gather_rule,
                        'params':vm.job.params,
                    },
                }).then((res) =>{
                    let status=res['data']['result'];
                    if(status){
                        $('.unexecuted').css('display','none');
                        $('.success').css('display','block');
                        $('.error').css('display','none');
                        $('.loading').css('display','none');
                    }else {
                        $('.unexecuted').css('display','none');
                        $('.success').css('display','none');
                        $('.error').css('display','block');
                        $('.loading').css('display','none');
                    }
                })
            },
            rowclass({row, rowIndex}) {
                return 'background:#F7F7F7'
            },
            font_size() {        //修改流程单元中的表字体
                $("#canvas").find('*').css("font-size", this.flow.font_size)
            },
            flow_height() {      //修改流程单元中的高
                $("#canvas").find('*').css("height", this.flow.height)
            },
            flow_width() {       //修改流程单元中的宽
                $("#canvas").find('*').css("width", this.flow.height)
            },

            get_db_connections() {
                axios({
                    url: '${SITE_URL}db_connection/get_all_db_connection/',
                    method: 'post',
                }).then((res) => {
                    let json = [];

                    if (res.data.results.length > 0) {
                        for (let i = 0; i < res.data.results.length; i++) {
                            let j = {};
                            j.value = res.data.results[i].id;
                            j.label = res.data.results[i].connname;
                            json.push(j);
                        };
                        this.sites1 = json;
                    }

                }).catch((res) => {
                    console.log('获取数据库连接错误')
                })
            },
            //初始化
            Initialization(){
                Object.assign(vm.basic, {});
                Object.assign(vm.basic, vm.basic1);
                Object.assign(vm.job, {});
                Object.assign(vm.job, vm.job1);
                Object.assign(vm.flow, {});
                Object.assign(vm.flow, vm.flow7);
                Object.assign(vm.chart, {});
                Object.assign(vm.chart, vm.chart1);
                vm.server_url = '';
                vm.file_param = '';
            },
            //显示图标
            show_chart() {
                if (this.myChart != null && this.myChart != "" && this.myChart != undefined) {
                    this.myChart.dispose();
                }
                if (vm.chart.gather_params == "饼图") {
                    this.myChart = echarts.init(document.getElementById('maintenancePie'), 'macarons');
                    let legendData = [];
                    for(let i=0;i<vm.chartData.length;i++){
                        this.$set(legendData,i,vm.chartData[i].name);
                    }

                    option = {
                        tooltip: {
                            trigger: 'item',
                            formatter: "{a} <br/>{b} : {c} ({d}%)"
                        },
                        legend: {
                            type: 'scroll',
                            orient: 'vertical',
                            right: 10,
                            bottom: 50,
                            data: legendData
                        },
                        series: [
                            {
                                name:vm.person_count,
                                type: 'pie',
                                radius: '50%',
                                center: ['50%', '30%'],
                                data: vm.chartData,
                                itemStyle: {
                                    emphasis: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                },
                                avoidLabelOverlap: false,
                                label: {
                                    normal: {
                                        show: true,
                                        position: 'inside',
                                        formatter: '{c}'
                                    }
                                },
                                labelLine: {
                                    normal: {
                                        show: false
                                    },
                                    emphasis: {
                                        show: true
                                    }
                                }
                            }
                        ]
                    };
                    this.myChart.setOption(option);
                }
                if (vm.chart.gather_params == "柱状图") {

                    this.myChart = echarts.init(document.getElementById('maintenancePie'), 'macarons');
                    let barX=[];
                    let barCount=[];
                    for(var i=0;i<vm.chartData.length;i++){
                        this.$set(barX,i,vm.chartData[i].name);
                        this.$set(barCount,i,vm.chartData[i].value);
                    }
                    option = {
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                                type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                            }
                        },
                        barWidth: 15,
                        legend: {
                            data: ['已执行'],
                            bottom: 10,
                            right: 30
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            top: 10,
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: barX
                        },
                        yAxis: {
                            type: 'value'
                        },
                        series: [
                            {
                                name: vm.person_count,
                                type: 'bar',
                                stack: 'data',
                                data: barCount
                            },
                            {
                                name: vm.person_count,
                                type: 'bar',
                                stack: 'data',
                                data: barCount
                            },
                        ]
                    };
                    this.myChart.setOption(option);
                }
                if (vm.chart.gather_params == "折线图") {
                    this.myChart = echarts.init(document.getElementById('maintenancePie'), 'macarons');
                    let lineX = [];
                    let lineCount = [];
                    for(var i=0;i<vm.chartData.length;i++){
                        this.$set(lineX,i,vm.chartData[i].name);
                        this.$set(lineCount,i,vm.chartData[i].value);
                    }
                    option = {
                        tooltip: {
                            trigger: 'axis'
                        },
                        legend: {
                            data: [vm.person_count]
                        },
                        calculable: true,
                        xAxis: [
                            {
                                type: 'category',
                                boundaryGap: false,
                                data: lineX
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value'
                            }
                        ],
                        series: [
                            {
                                name: vm.person_count,
                                type: 'line',
                                smooth: true,
                                itemStyle: {normal: {areaStyle: {type: 'default'}}},
                                data: lineCount
                            },
                        ]
                    };
                    this.myChart.setOption(option);
                }
                vm.echart_height();
                vm.echart_width();
            },
            show_content(){
                let content=vm.chart.contents;
                let obj = JSON.parse(content);
                let echartData = [];
                for(let i=0;i<obj.X.v.length;i++){
                    let obj_1={};
                    obj_1.name=obj.X.v[i];
                    obj_1.value=obj.Y.v[i];
                    this.$set(echartData,i,obj_1);
                }
                vm.chartData=echartData;
                vm.show_chart();
                vm.echart_height();
                vm.echart_width();
            },
            chart_get_test(){
                axios({
                    url:'${SITE_URL}monitor/chart_get_test/',
                    method:'post',
                    data:{
                        database_id:vm.chart.params,
                        sql:vm.chart.gather_rule,
                    },
                }).then((res) => {
                    console.log(res)
                    if(res.data.result){
                        this.$message({
                            message:'数据采集成功，请选择图表类型进行查看！',
                            type:'success',
                            center:true
                        })
                    }else{
                        this.$message({
                            message:'数据采集失败，请检查数据配置或采集规则！',
                            type:'warning',
                            center:true
                        })
                    }
                    vm.chartData=res.data.results;
                    vm.person_count=res.data.column_name_list[0];
                    vm.show_chart();
                    vm.echart_height();
                    vm.echart_width();
                }).catch((res) =>{
                    console.log(res)
                });
            },
            echart_height(){
                $('#maintenanceIndex').find("canvas").css('height',vm.chart.height);
            },
            echart_width(){
                $('#maintenanceIndex').find("canvas").css('width',vm.chart.width)
            },
            switch_change(value){
                console.log(value);
                axios({
                    method: 'post',
                    url: '${SITE_URL}monitor/change_status/',
                    data: {
                        flag: value.status,
                        id: value.id,
                        monitor_name: value.monitor_name
                    },
                }).then((res) =>{
                    if (res.data.code == 1) {alert(res.data.message)}
                })
            },
        },
        mounted() {
        },
    });
    vm.show();
</script>
<script>
    setInterval(function () {
        $('input[type=number]').keypress(function (e) {
            if (!String.fromCharCode(e.keyCode).match(/[0-9\.]/)) {
                return false;
            }
        });
    }, 1)
</script>


<script>
    setInterval(function () {


        //flow1_js_start

        //flow1_js_end
        // $('.node-wrapper').click(function () {
        //
        //     $(this).find(".node-title").attr('contenteditable','plaintext-only');
        // })


    }, 1000)
</script>
</html>